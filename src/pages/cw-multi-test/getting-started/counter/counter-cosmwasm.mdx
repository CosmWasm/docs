---
tags: ["multitest", "getting started", "counter", "CosmWasm"]
---

import { Card, Cards } from "nextra/components";

# Counter written in CosmWasm

## Counter source code

The following code snippets present the content of [**Cargo.toml**](#cargotoml),
[**lib.rs**](#librs), [**msg.rs**](#msgrs), and [**contract.rs**](#contractrs) files, respectively.
YouÂ can just copy and paste the provided content to previously created empty files, temporarily
skipping the detailed explanations. However, if you're curious about what happens inside each file,
feel free to check the detailed explanations provided for each code snippet.

### Cargo.toml

```toml filename="Cargo.toml" copy
[package]
name = "counter"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[lib]
crate-type = ["cdylib", "rlib"]

[features]
# use library feature to disable all instantiate/execute/query exports
library = []

[dependencies]
cosmwasm-schema = "2"
cosmwasm-std = { version = "2" }
cw-storage-plus = "2"
schemars = "0.8"
serde = "1.0"

[dev-dependencies]
cw-multi-test = { version = "2", features = ["cosmwasm_2_0"] }
```

**Detailed explanation**

<Cards>
  <Card title="ðŸ¦˜Â Â Skip this time" href="#librs" icon="" children="" />
</Cards>

(todo: extremely detailed explanation)

### lib.rs

```rust filename="lib.rs" copy
pub mod contract;
pub mod msg;
```

**Detailed explanation**

<Cards>
  <Card title="ðŸ¦˜Â Â Skip this time" href="#msgrs" icon="" children="" />
</Cards>

(todo: extremely detailed explanation)

### msg.rs

```rust filename="msg.rs" copy
use cosmwasm_schema::cw_serde;

#[cw_serde]
pub enum CounterInitMsg {
    Zero,
    Set(u8),
}

#[cw_serde]
pub enum CounterActionMsg {
    Inc,
    Dec,
    Set(u8),
}

#[cw_serde]
pub enum CounterQuery {
    Value,
}

#[cw_serde]
pub struct CounterResponse {
    pub value: u8,
}
```

**Detailed explanation**

<Cards>
  <Card title="ðŸ¦˜Â Â Skip this time" href="#contractrs" icon="" children="" />
</Cards>

(todo: extremely detailed explanation)

### contract.rs

```rust filename="contract.rs" copy
#[cfg(not(feature = "library"))]
use cosmwasm_std::entry_point;

use crate::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
use cosmwasm_std::{to_json_binary, Binary, Deps, DepsMut, Env, MessageInfo, Response, StdError};
use cw_storage_plus::Item;

const COUNTER: Item<u8> = Item::new("value");

#[cfg_attr(not(feature = "library"), entry_point)]
pub fn instantiate(
    deps: DepsMut,
    _env: Env,
    _info: MessageInfo,
    msg: CounterInitMsg,
) -> Result<Response, StdError> {
    COUNTER.save(
        deps.storage,
        &match msg {
            CounterInitMsg::Zero => 0,
            CounterInitMsg::Set(value) => value,
        },
    )?;
    Ok(Response::default())
}

#[cfg_attr(not(feature = "library"), entry_point)]
pub fn execute(
    deps: DepsMut,
    _env: Env,
    _info: MessageInfo,
    msg: CounterActionMsg,
) -> Result<Response, StdError> {
    COUNTER.update::<_, StdError>(deps.storage, |old_value| {
        Ok(match msg {
            CounterActionMsg::Inc => old_value.saturating_add(1),
            CounterActionMsg::Dec => old_value.saturating_sub(1),
            CounterActionMsg::Set(new_value) => new_value,
        })
    })?;
    Ok(Response::default())
}

#[cfg_attr(not(feature = "library"), entry_point)]
pub fn query(deps: Deps, _env: Env, msg: CounterQuery) -> Result<Binary, StdError> {
    match msg {
        CounterQuery::Value => Ok(to_json_binary(&CounterResponse {
            value: COUNTER.may_load(deps.storage).unwrap().unwrap(),
        })?),
    }
}
```

**Detailed explanation**

<Cards>
  <Card title="ðŸ¦˜Â Â Skip this time" href="#what-next" icon="" children="" />
</Cards>

(todo: extremely detailed explanation)

## What next?

Having the **counter** smart contract ready, you can begin [writing tests](../writing-tests) using
**`MultiTest`**.

Or you can check the Sylvia version.

(todo: add cards here)
