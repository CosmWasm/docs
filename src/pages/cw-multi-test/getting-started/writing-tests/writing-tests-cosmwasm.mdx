---
tags: ["multitest", "getting started", "tests", "CosmWasm"]
---

# Writing tests in CosmWasm

```rust copy
use cosmwasm_std::Empty;
use cw_multi_test::{Contract, ContractWrapper};

fn counter_contract() -> Box<dyn Contract<Empty>> {
    Box::new(ContractWrapper::new_with_empty(
        counter::contract::execute,
        counter::contract::instantiate,
        counter::contract::query,
    ))
}
```

```rust copy
#[test]
fn instantiating_with_zero_should_work() {
    use counter::msg::{CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Zero,
            &[],
            "counter",
            None,
        )
        .unwrap();

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(0, res.value);
}
```

```rust copy
#[test]
fn instantiating_with_value_should_work() {
    use counter::msg::{CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Set(12),
            &[],
            "counter",
            None,
        )
        .unwrap();

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(12, res.value);
}
```

```rust copy
#[test]
fn incrementing_should_work() {
    use counter::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Zero,
            &[],
            "counter",
            None,
        )
        .unwrap();

    app.execute_contract(owner, contract_addr.clone(), &CounterActionMsg::Inc, &[])
        .unwrap();

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(1, res.value);
}
```

```rust copy
#[test]
fn incrementing_should_stop_at_maximum() {
    use counter::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Set(250),
            &[],
            "counter",
            None,
        )
        .unwrap();

    for _ in 1..=10 {
        app.execute_contract(
            owner.clone(),
            contract_addr.clone(),
            &CounterActionMsg::Inc,
            &[],
        )
        .unwrap();
    }

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(255, res.value);
}
```

```rust copy
#[test]
fn decrementing_should_work() {
    use counter::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Set(126),
            &[],
            "counter",
            None,
        )
        .unwrap();

    app.execute_contract(owner, contract_addr.clone(), &CounterActionMsg::Dec, &[])
        .unwrap();

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(125, res.value);
}
```

```rust copy
#[test]
fn decrementing_should_stop_at_minimum() {
    use counter::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Set(5),
            &[],
            "counter",
            None,
        )
        .unwrap();

    for _ in 1..=10 {
        app.execute_contract(
            owner.clone(),
            contract_addr.clone(),
            &CounterActionMsg::Dec,
            &[],
        )
        .unwrap();
    }

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(0, res.value);
}
```

```rust copy
#[test]
fn setting_value_should_work() {
    use counter::msg::{CounterActionMsg, CounterInitMsg, CounterQuery, CounterResponse};
    use cw_multi_test::{App, Executor, IntoAddr};

    let mut app = App::default();

    let code_id = app.store_code(counter_contract());
    let owner = "owner".into_addr();

    let contract_addr = app
        .instantiate_contract(
            code_id,
            owner.clone(),
            &CounterInitMsg::Set(5),
            &[],
            "counter",
            None,
        )
        .unwrap();

    app.execute_contract(
        owner.clone(),
        contract_addr.clone(),
        &CounterActionMsg::Set(126),
        &[],
    )
    .unwrap();

    let res: CounterResponse = app
        .wrap()
        .query_wasm_smart(contract_addr, &CounterQuery::Value)
        .unwrap();

    assert_eq!(126, res.value);
}
```
